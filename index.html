<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="stylesheet.css" />
    <title>Vertical Timeline</title>
  </head>
  <body>
    <!--    <div class="timeline">
      <div class="timeline__component">
        <div class="timeline__date timeline__date--right">August 30, 2017</div>
      </div>
      <div class="timeline__middle">
        <div class="timeline__point"></div>
      </div>
      <div class="timeline__component timeline__component--bg">
        <h2 class="timeline__title">TITLE</h2>
        <p class="timeline__paragraph">
          Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ad dolorem
          ullam ipsum nostrum nisi quis iure hic quod optio in!
        </p>
      </div>

      <div
        class="timeline__component timeline__component--bottom timeline__component--bg"
      >
        <h2 class="timeline__title">TITLE</h2>
        <p class="timeline__paragraph">
          Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ad dolorem
          ullam ipsum nostrum nisi quis iure hic quod optio in!
        </p>
      </div>
      <div class="timeline__middle">
        <div class="timeline__point"></div>
        <div class="timeline__point timeline__point--bottom"></div>
      </div>
      <div class="timeline__component timeline__component--bottom">
        <div class="timeline__date">August 30, 2017</div>
      </div>
    </div> -->

    <script>
      const url =
        "https://script.google.com/macros/s/AKfycbzUx0QHPum48H8BwK0X9A0k9972HaAsMxj2RjCdO0so7lKCDaUXC9f8lLq8xn6DS6wsTw/exec";
      const getHolidays = async () => {
        try {
          const res = await fetch(url);

          const holidays = await res.json();

          const container = document.createElement("div");
          container.classList = "timeline";
          container.innerHTML = holidays
            .map((holiday, holidayIndex) => {
              const [yr, mo, dy] = holiday.start.split("-");
              const date = new Date(
                yr,
                parseInt(mo) - 1,
                dy,
                0,
                0,
                0
              ).toDateString();

              if (holidayIndex % 2 == 0) {
                return `<div class="timeline__component">
                  <div class="timeline__date timeline__date--right">${date}</div>
                </div>
                <div class="timeline__middle">
                  <div class="timeline__point"></div>
                </div>
                <div class="timeline__component timeline__component--bg">
                  <h2 class="timeline__title">${holiday.summary}</h2>
                  <p class="timeline__paragraph">
                    Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ad dolorem
                    ullam ipsum nostrum nisi quis iure hic quod optio in!
                  </p>
                </div>`;
              } else {
                return ` <div
                    class="timeline__component ${
                      holidayIndex === holidays.length - 1
                        ? `timeline__component--bottom`
                        : ""
                    } timeline__component--bg"
                  >
                    <h2 class="timeline__title">${holiday.summary}</h2>
                    <p class="timeline__paragraph">
                      Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ad dolorem
                      ullam ipsum nostrum nisi quis iure hic quod optio in!
                    </p>
                  </div>
                  <div class="timeline__middle">
                    <div class="timeline__point"></div>
                    ${
                      holidayIndex === holidays.length - 1
                        ? `<div class="timeline__point timeline__point--bottom"></div>`
                        : ""
                    }
                  </div>
                  <div class="timeline__component ${
                    holidayIndex === holidays.length - 1
                      ? ` timeline__component--bottom`
                      : ""
                  }">
                    <div class="timeline__date">${date}</div>
                  </div>`;
              }
            })
            .join("");

          document.body.insertAdjacentElement("afterbegin", container);
        } catch (err) {
          console.log(err.message);
        }
      };

      getHolidays();
    </script>
  </body>
</html>
